<!--<!DOCTYPE html>-->
<!--<html lang="ko" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="utf-8"/>-->
<!--    <title>Ingredient Upload</title>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Upload Ingredient</h1>-->
<!--<form id="ingredientForm" enctype="multipart/form-data">-->
<!--    &lt;!&ndash; 1) 기본 텍스트 필드들 &ndash;&gt;-->
<!--    <div>-->
<!--        <label for="name">Name</label>-->
<!--        <input id="name" name="name" type="text" required/>-->
<!--    </div>-->
<!--    <div>-->
<!--        <label for="description">Description</label>-->
<!--        <input id="description" name="description" type="text" required/>-->
<!--    </div>-->

<!--    <div>-->
<!--        <label for="avb">avb</label>-->
<!--        <input id="avb" name="avb" type="text" required/>-->
<!--    </div>-->


<!--    <div>-->
<!--        <label for="category">Category</label>-->
<!--        <input id="category" name="category" type="text" required/>-->
<!--    </div>-->

<!--    <div>-->
<!--        <label for="imageFile">Ingredient Image</label>-->
<!--        <input id="imageFile" name="imageFile" type="file" accept="image/*"/>-->
<!--    </div>-->

<!--    &lt;!&ndash; 4) Submit 버튼 &ndash;&gt;-->
<!--    <button id="submitFormBtn" type="submit">Create</button>-->
<!--</form>-->

<!--<script th:nonce="${scriptNonce}">-->
<!--    document.addEventListener('DOMContentLoaded', function () {-->
<!--        async function submitForm() {-->
<!--            // form 태그 자체를 가져옴-->
<!--            const form = document.getElementById('ingredientForm');-->
<!--            // FormData 객체에 form 태그의 모든 요소를 담음-->
<!--            const formData = new FormData(form);-->
<!--            try {-->
<!--                // Spring Boot 서버 주소 (예: 로컬호스트)-->
<!--                const response = await fetch('/api/ingredients', {-->
<!--                    method: 'POST',-->
<!--                    body: formData,-->
<!--                    // credentials: "include" // 쿠키가 포함되도록 설정-->
<!--                })-->
<!--                    .then(response => response.json())-->
<!--                    .then(data=>{-->
<!--                    if (data.success) {-->
<!--                        alert('재료가 성공적으로 등록되었습니다.');-->
<!--                        window.location.href = '/ingredients';-->
<!--                    } else {-->
<!--                        alert('재료 등록에 실패했습니다: ' + data.message);-->
<!--                    }-->
<!--                }).catch(error=> {-->
<!--                    alert('Error: ' + error.message);-->
<!--                });-->
<!--                console.log("api 호출 직후");-->

<!--                // if (response.ok) {-->
<!--                //     console.log("요청 성공");-->
<!--                //-->
<!--                //     const result = await response.text();-->
<!--                //     alert(' created successfully!\n\nServer response:\n' + result);-->
<!--                //-->
<!--                // } else {-->
<!--                //     throw new Error('Server Error: ' + response.status);-->
<!--                // }-->
<!--            } catch (error) {-->
<!--                alert('Error: ' + error.message);-->
<!--            }-->
<!--        }-->

<!--        const submitButton = document.getElementById("submitFormBtn");-->
<!--        submitButton.addEventListener("click", submitForm);-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>재료 등록</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 600px;
            margin-top: 50px;
        }
    </style>
</head>
<body>
<div class="container">
    <h2 class="mb-4">재료 등록</h2>

    <form th:action="@{/api/ingredients}" method="post" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="name" class="form-label">재료명</label>
            <input type="text" class="form-control" id="name" name="name" required>
        </div>

        <div class="mb-3">
            <label for="description" class="form-label">설명</label>
            <textarea class="form-control" id="description" name="description" rows="1" required></textarea>
        </div>

        <div class="mb-3">
            <label for="category" class="form-label">카테고리</label>
            <input type="text" class="form-control" id="category" name="category" required>
        </div>

        <div class="mb-3">
            <label for="avb" class="form-label">도수 (ABV)</label>
            <input type="number" class="form-control" id="avb" name="avb"
                   step="0.1" min="0" max="100" required>
        </div>

        <div class="mb-3">
            <label for="imageFile" class="form-label">이미지</label>
            <input type="file" class="form-control" id="imageFile" name="imageFile"
                   accept="image/*">
        </div>

        <button type="submit" class="btn btn-primary">등록</button>
        <a href="/ingredients" class="btn btn-secondary">취소</a>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.querySelector('form').addEventListener('submit', function(e) {
        e.preventDefault();

        const formData = new FormData(this);

        fetch('/api/ingredients', {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('재료가 성공적으로 등록되었습니다.');
                    window.location.href = '/ingredients';
                } else {
                    alert('재료 등록에 실패했습니다: ' + data.message);
                }
            })
            .catch(error => {
                alert('오류가 발생했습니다: ' + error);
            });
    });
</script>
</body>
</html>